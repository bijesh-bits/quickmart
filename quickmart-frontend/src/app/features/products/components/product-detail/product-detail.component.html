<div class="p-4">
  <p-button label="Back to Products" icon="pi pi-arrow-left" styleClass="p-button-text mb-4" (onClick)="goBack()"></p-button>

  <div *ngIf="loading" class="loading-container">
    <p-progressSpinner></p-progressSpinner>
    <h2 class="mt-3">Loading Product...</h2>
  </div>

  <div *ngIf="!loading && !product" class="error-container">
    <i class="pi pi-exclamation-triangle"></i>
    <h2>Product Not Found</h2>
    <p>Sorry, we couldn't find the product you're looking for.</p>
  </div>

  <div *ngIf="!loading && product" class="product-detail-container">
    <div class="grid">
      <!-- Product Image -->
      <div class="col-12 md:col-6">
        <div class="product-image-gallery">
          <img [src]="getProductImageUrl(product.imageUrl)" [alt]="product.productName" (error)="handleImageError($event)">
        </div>
      </div>

      <!-- Product Info -->
      <div class="col-12 md:col-6 product-info">
        <h1 class="product-title">{{ product.productName }}</h1>
        <div class="unit">{{ product.unit }}</div>
        
        <div class="price-section flex align-items-center gap-3">
          <span class="current-price">{{ (product.discountPrice || product.price) | currency:'INR' }}</span>
          <span *ngIf="product.discountPrice" class="original-price">{{ product.price | currency:'INR' }}</span>
          <p-tag *ngIf="getDiscountPercentage() > 0" [value]="getDiscountPercentage() + '% OFF'" severity="success"></p-tag>
        </div>

        <div class="stock-status">
          <p-tag *ngIf="product.stockQuantity > 10" value="In Stock" severity="success"></p-tag>
          <p-tag *ngIf="product.stockQuantity > 0 && product.stockQuantity <= 10" [value]="'Only ' + product.stockQuantity + ' left'" severity="warning"></p-tag>
          <p-tag *ngIf="product.stockQuantity === 0" value="Out of Stock" severity="danger"></p-tag>
        </div>

        <p class="description">{{ product.description }}</p>

        <div class="actions">
          <p-inputNumber [(ngModel)]="quantity" [showButtons]="true" [min]="1" [max]="product.stockQuantity" buttonLayout="horizontal" incrementButtonIcon="pi pi-plus" decrementButtonIcon="pi pi-minus"></p-inputNumber>
          <button pButton type="button" label="Add to Cart" icon="pi pi-shopping-cart" styleClass="p-button-lg" (click)="addToCart()" [disabled]="product.stockQuantity === 0"></button>
        </div>
      </div>
    </div>
  </div>
</div>
